<html>
<head>
<title>diceRoll.js example</title>
<script src="./domready.js"></script>
<script src="../../build/diceRoll.min.js"></script>
</head>
<body>
<script>
domready(function(){
	var
		form = document.forms[0],
		spec = form.querySelector('input'),
		button = form.querySelector('button'),
		output = form.querySelector('#output'),
		roll = undefined,
		regex = diceRoll.regex.toString(),
		regex = '^' + regex.substring(1, regex.length - 1) + '$',
		resultIndex = [],
		resultsCheck = [],
		results = [],
		genOutput = function(){
			while(output.hasChildNodes()){
				output.removeChild(output.firstChild);
			}
			try{
				if(roll == undefined || spec.value != roll._spec){
					roll = new diceRoll(spec.value);
				}
				resultIndex = [];
				resultsCheck = [];
				results = roll.multiRoll(10000000);
				for(var i=0;i<results.length;++i){
					var
						pos = resultIndex.indexOf(results[i])
					;
					if(pos == -1){
						pos = resultIndex.length;
						resultIndex.push(results[i]);
						resultsCheck[pos] = 0;
					}
					++resultsCheck[pos];
				}
				results = resultIndex;
				results.sort(function(a,b){ return a-b;});
				for(var i=0;i<results.length;++i){
					var
						tr = document.createElement('tr'),
						th = document.createElement('th'),
						td = document.createElement('td')
					;
					th.scope = 'row';
					th.appendChild(document.createTextNode(results[i]));
					td.appendChild(document.createTextNode(resultsCheck[resultIndex.indexOf(results[i])]));
					tr.appendChild(th);
					tr.appendChild(td);
					output.appendChild(tr);
				}
			}catch(e){
				alert(e);
			}
			return false;
		}
	;
	button.disabled = spec.disabled = false;
	spec.pattern = regex;
	form.onsubmit = genOutput;
	genOutput();
})
</script>
<form>
	<ul>
		<li><label for=spec>Specification: </label><input disabled required id=spec value="2d+10"></li>
		<li><button type=submit disabled>Roll</button></li>
	</ul>
	<table>
		<thead>
			<tr>
				<th>Result</th>
				<th>Value</th>
			</tr>
		</thead>
		<tbody id=output>
		</tbody>
	</table>
</form>
</body>
</html>