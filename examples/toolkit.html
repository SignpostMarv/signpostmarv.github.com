<!DOCTYPE html>
<html>
<head>
<title>mapgen.js toolkit</title>
<meta charset="UTF-8" />
<script src="../src/mapgen.js" defer></script>
<script defer>
window.onload = function(){
	var
		render = document.createElement('canvas'),
		form = document.querySelector('form'),
		gen,
		ctx
	;
	function doDraw(map){
		var
			draw = map.draw();
		;
		ctx.save();
		ctx.fillStyle = '#eee';
		ctx.fillRect(0, 0, render.width, render.height);
		ctx.translate(400 + (draw.width / -2), 400 + (draw.height / -2));
		ctx.drawImage(draw, 0, 0);
		ctx.restore();
	}

	function prefUpdate(){
		var
			checkOpts = [
				'renderWidth',
				'renderHeight',
				'roadWidth',
				'lineWidth',
				'radius'
			],
			opts = {}
		;
		checkOpts.forEach(function(e){
			var
				el = form.querySelector('#' + e)
			;
			if(el){
				opts[e] = el.value;
			}
		});
		gen = new mapgen(opts);
	}
	prefUpdate();
	render.width = render.height = 800;
	ctx = render.getContext('2d');
	document.body.appendChild(render);
	doDraw(gen);
	form.onsubmit = function(e){
		e.preventDefault();
		doDraw(gen);
		return false;
	}

	form.oninput = form.onchange = function(e){
		switch(e.target.nodeName){
			case 'INPUT':
				var
					output = form.querySelector('output[for="' + e.target.id + '"]'),
					id = e.target.id,
					opts = {}
				;
				while(output.hasChildNodes()){
					output.removeChild(output.firstChild);
				}
				output.appendChild(document.createTextNode(e.target.value));
				prefUpdate();
			break;
		}
	}
}
</script>
<style>
canvas{
	background: #fff ;
}
form{
	float: left ;
}
</style>
</head>
<body>
<form>
	<p><a href="https://github.com/SignpostMarv/mapgen.js">GitHub repo</a></p>
	<fieldset>
		<legend>Toolkit</legend>
		<ul>
			<li><label for=renderWidth>Render Width: </label><input id=renderWidth type=range min=100 max=800 value=800><output for=renderWidth>800</output></li>
			<li><label for=renderHeight>Render Height: </label><input id=renderHeight type=range min=100 max=800 value=800><output for=renderHeight>800</output></li>
			<li><label for=roadWidth>Road Width: </label><input id=roadWidth type=range min=4 max=64 value=16><output for=roadWidth>16</output></li>
			<li><label for=lineWidth>Line Width: </label><input id=lineWidth type=range min=4 max=64 value=16><output for=lineWidth>16</output></li>
			<li><label for=radius>Radius: </label><input id=radius type=range min=4 max=64 value=16><output for=radius>16</output></li>
		</ul>
	</fieldset>
	<button type=submit>Redraw</button>
</form>
</body>
</html>
